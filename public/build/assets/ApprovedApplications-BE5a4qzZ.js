import{Q as X}from"./QSpace-CwjI2j8j.js";import{T as O,r as y,S as Z,j as ee,o as m,d as T,w as n,b as t,a as l,Q as te,a2 as le,R as ae,n as r,m as se,_ as w,$ as k,a0 as N,t as d,c as f,p as q,W as ne,a1 as oe,Y as ie,F as j,e as P,g as L,v as R,u as E,V as F}from"./app-BWru0xgJ.js";import{Q as de}from"./QTabs-De-l5Dxp.js";import{Q as V}from"./QSelect-Xlbisqrv.js";import{Q as re}from"./QBtnDropdown-DQa2vMX0.js";import{Q as I}from"./QBanner-CTBfnJ0K.js";import{Q as ue,c as pe,a as M}from"./QLayout-B2UCfxJP.js";import{Q as me}from"./QPage-BxqPVTq1.js";import{A as ce}from"./Admin-D6fNS5tg.js";import{u as ge}from"./use-quasar-3rZ_2sXh.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./rtl-DFPa-2ov.js";import"./QChip-DEM5vRWG.js";import"./QMenu-DxMahAam.js";const fe={class:"flex justify-between items-center zcard q-pa-md"},be={class:"flex items-center q-gutter-md"},ve={class:"row q-mt-sm"},ye={class:"page-title"},ke={class:"col-xs-12"},Ce={class:"table-auto border-collapse border border-gray-300 w-full mt-6 text-sm"},_e={class:"bg-gray-100"},he={class:"px-4 py-2 text-left text-gray-600"},Ae=["checked"],we={class:"px-4 py-2"},Ve=["value"],Qe={class:"px-4 py-2"},Se={class:"px-4 py-2"},De={class:"px-4 py-2"},Ne={class:"px-4 py-2"},qe={class:"px-4 py-2"},je={class:"px-4 py-2"},Pe={class:"px-4 py-2"},Ee={class:"px-4 py-2"},Fe=["onClick"],Ie={class:"px-4 py-2"},Ue=["onClick"],$e={class:"flex justify-between items-center mt-4"},Be={class:"flex items-center q-gutter-sm"},Oe={class:"text-gray-600"},Te={class:"text-h6 q-mb-md"},Le={key:0},Re={key:1},Me={key:2},ze={class:"q-pa-sm"},Ye={class:"text-caption"},Ke={class:"text-h6"},Je=Object.assign({layout:ce},{__name:"ApprovedApplications",props:["jobDetails","examCenters","applications","search","perPage"],setup(i){const C=ge(),u=i,g=O({application_ids:[],status:""}),v=O({exam_center_id:[],application_ids:[]}),h=y(!1),_=y(!1),z=s=>{b.value=s.applicant,h.value=!0},Y=()=>{_.value=!0},p=Z({search:u==null?void 0:u.search,tab:route().current(),perPage:(u==null?void 0:u.perPage)||2});y("");const U=s=>{F.get(route("admin.applications.show_approved",u.jobDetails.id),{search:p.search,perPage:p.perPage})},K=s=>{F.get(route(s))},A=s=>{s&&F.get(s,{search:p.search,perPage:p.perPage})};y(!1);const b=y(null),o=y([]),J=ee({get:()=>u.applications.data.length>0&&o.value.length===u.applications.data.length,set:s=>$(s)});function $(s){o.value=s?u.applications.data.map(e=>e.id):[]}const W=()=>{v.application_ids=o.value,v.post(route("exams.allotCenters"),{onSuccess:()=>{var e;const s="Exam Center assigned for "+((e=o.value)==null?void 0:e.length)+" applications";C.notify({type:"positive",message:s}),_.value=!1,v.reset()},onError:s=>{console.error(s),alert("An error occurred while assigning exam centers.")}})},G=()=>{var s;g.application_ids=o.value,g.status="pending",C.dialog({title:"Confirmation",message:"Do you want to proceed with "+((s=o.value)==null?void 0:s.length)+" Applications",ok:"Yes",cancel:"No"}).onOk(()=>{g.put(route("admin.applications.bulkChangeStatus"),{onSuccess:()=>{var x;const e=((x=o.value)==null?void 0:x.length)+" Applications marked as disqualified";C.notify({type:"positive",message:e}),g.reset(),o.value=[]}})})},H=()=>{var s;if(o.value.length===0){alert("Please select at least one applicant.");return}g.application_ids=o.value,g.status="eligible",C.dialog({title:"Confirmation",message:"Do you want to proceed with "+((s=o.value)==null?void 0:s.length)+" Applications",ok:"Yes",cancel:"No"}).onOk(()=>{g.put(route("admin.applications.bulkChangeStatus"),{onSuccess:()=>{var x;const e=((x=o.value)==null?void 0:x.length)+" Applications marked as eligible";C.notify({type:"positive",message:e}),g.reset(),o.value=[]}})})};return(s,e)=>(m(),T(me,{padding:""},{default:n(()=>{var x;return[e[33]||(e[33]=t("p",{class:"page-title"},"QUALIFIED LIST",-1)),t("div",fe,[l(de,{stretch:"",shrink:"",modelValue:p.tab,"onUpdate:modelValue":[e[1]||(e[1]=a=>p.tab=a),K],align:"start"},{default:n(()=>[l(X),l(te,{modelValue:p.search,"onUpdate:modelValue":e[0]||(e[0]=a=>p.search=a),autofocus:"",outlined:"",dense:"",onKeyup:le(U,["enter"]),"bg-color":"white",placeholder:"Search"},{append:n(()=>[l(ae,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),t("div",be,[l(r,{onClick:Y,color:"primary",disabled:o.value.length===0,label:"Assign Exam Center"},null,8,["disabled"]),l(r,{onClick:G,color:"primary",disabled:o.value.length===0,label:"Mark as Disqualified"},null,8,["disabled"]),l(r,{onClick:H,color:"primary",disabled:o.value.length===0,label:"Mark as Eligible"},null,8,["disabled"]),l(se,{vertical:""}),l(re,{class:"q-ma-xs q-pa-xs",color:"primary",flat:"","dropdown-icon":"sort"},{default:n(()=>[l(w,{class:"q-pa-sm",style:{"min-width":"280px"}},{default:n(()=>[l(k,null,{default:n(()=>e[16]||(e[16]=[t("p",{class:"q-ma-none ztext-lg"},"Filter",-1)])),_:1}),l(k,null,{default:n(()=>[l(V,{modelValue:s.filterData.job,"onUpdate:modelValue":e[2]||(e[2]=a=>s.filterData.job=a),options:s.jobs,class:"my-input",dense:"",label:"Job",outlined:""},null,8,["modelValue","options"])]),_:1}),l(k,null,{default:n(()=>[l(V,{modelValue:s.filterData.district,"onUpdate:modelValue":e[3]||(e[3]=a=>s.filterData.district=a),options:s.districts,class:"my-input",dense:"",label:"District",outlined:""},null,8,["modelValue","options"])]),_:1}),l(N,null,{default:n(()=>[l(r,{flat:"",label:"Reset",onClick:s.resetFilter},null,8,["onClick"]),l(r,{color:"primary",label:"Filter",rounded:"",style:{"min-width":"100px"},onClick:s.doFilter},null,8,["onClick"])]),_:1})]),_:1})]),_:1})])]),t("div",ve,[t("p",ye,d((x=i.jobDetails)==null?void 0:x.post_name)+" : APPLICATIONS",1),t("div",ke,[t("table",Ce,[t("thead",_e,[t("tr",null,[t("th",he,[t("input",{type:"checkbox",onChange:e[4]||(e[4]=a=>$(a.target.checked)),checked:J.value},null,40,Ae)]),e[17]||(e[17]=t("th",{class:"px-4 py-2 text-left text-gray-600"},"Applicant Name",-1)),e[18]||(e[18]=t("th",{class:"px-4 py-2 text-left text-gray-600"},"Application No",-1)),e[19]||(e[19]=t("th",{class:"px-4 py-2 text-left text-gray-600"},"Roll No",-1)),e[20]||(e[20]=t("th",{class:"px-4 py-2 text-left text-gray-600"},"Parent Name",-1)),e[21]||(e[21]=t("th",{class:"px-4 py-2 text-left text-gray-600"},"Community",-1)),e[22]||(e[22]=t("th",{class:"px-4 py-2 text-left text-gray-600"},"Exam Center",-1)),e[23]||(e[23]=t("th",{class:"px-4 py-2 text-left text-gray-600"},"Status",-1)),e[24]||(e[24]=t("th",{class:"px-4 py-2 text-left text-gray-600"},"Actions",-1)),e[25]||(e[25]=t("th",{class:"px-4 py-2 text-left text-gray-600"},"Marks",-1))])]),t("tbody",null,[(m(!0),f(j,null,q(i.applications.data,a=>{var Q,c,S,B;return m(),f("tr",{key:a.id,class:"hover:bg-gray-50 transition duration-150"},[t("td",we,[ne(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=D=>o.value=D),value:a.id},null,8,Ve),[[oe,o.value]])]),t("td",Qe,d(((Q=a.applicant.user)==null?void 0:Q.name)||"N/A"),1),t("td",Se,d(a.application_id||"N/A"),1),t("td",De,d(a.roll_no||"N/A"),1),t("td",Ne,d(((c=a.applicant)==null?void 0:c.parents_name)||"N/A"),1),t("td",qe,d(((S=a.applicant)==null?void 0:S.community)||"N/A"),1),t("td",je,d(((B=a.exam_center)==null?void 0:B.center_name)||"N/A"),1),t("td",Pe,[t("span",{class:ie(["px-2 py-1 rounded-full text-xs font-semibold",a.status==="approved"?"bg-green-100 text-green-800":a.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"])},d(a.status||"Pending"),3)]),t("td",Ee,[t("button",{onClick:D=>s.$inertia.get(s.route("admin.application.show_applicant_detail",{jobDetails:i.jobDetails.id,application:a.id})),class:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-4 rounded mr-2 transition duration-150"}," OPEN ",8,Fe)]),t("td",Ie,[t("button",{onClick:D=>z(a),class:"bg-blue-500 hover:bg-blue-700 text-white py-1 px-4 rounded mr-2 transition duration-150"}," View Marks ",8,Ue)])])}),128))])]),t("div",$e,[l(V,{modelValue:p.perPage,"onUpdate:modelValue":[e[6]||(e[6]=a=>p.perPage=a),U],dense:"",outlined:"",options:[5,10,20,25],label:"Results per page",style:{width:"150px"}},null,8,["modelValue"]),t("div",Be,[l(r,{disable:i.applications.current_page===1,onClick:e[7]||(e[7]=a=>A(i.applications.first_page_url)),flat:"",round:"",icon:"first_page"},null,8,["disable"]),l(r,{disable:!i.applications.prev_page_url,onClick:e[8]||(e[8]=a=>A(i.applications.prev_page_url)),flat:"",round:"",icon:"chevron_left"},null,8,["disable"]),t("span",Oe," Page "+d(i.applications.current_page)+" of "+d(i.applications.last_page),1),l(r,{disable:!i.applications.next_page_url,onClick:e[9]||(e[9]=a=>A(i.applications.next_page_url)),flat:"",round:"",icon:"chevron_right"},null,8,["disable"]),l(r,{disable:i.applications.current_page===i.applications.last_page,onClick:e[10]||(e[10]=a=>A(i.applications.last_page_url)),flat:"",round:"",icon:"last_page"},null,8,["disable"])])])])]),l(R,{modelValue:h.value,"onUpdate:modelValue":e[12]||(e[12]=a=>h.value=a),persistent:""},{default:n(()=>[l(w,{style:{"min-width":"450px"}},{default:n(()=>[l(k,null,{default:n(()=>[t("div",Te,"Exam Details: "+d(b.value.user.name),1),b.value.exams.length===0?(m(),f("div",Le,[l(I,{class:"bg-warning text-black q-mb-md"},{default:n(()=>e[26]||(e[26]=[t("div",null,"No exams found for this applicant.",-1)])),_:1})])):P("",!0),b.value.exam_marks.length===0?(m(),f("div",Re,[l(I,{class:"bg-warning text-black q-mb-md"},{default:n(()=>e[27]||(e[27]=[t("div",null,"No marks assigned for the selected exams.",-1)])),_:1})])):P("",!0),b.value.exam_marks.length!==0?(m(),f("div",Me,[(m(!0),f(j,null,q(b.value.exams,(a,Q)=>(m(),f("div",{key:a.id,class:"q-mt-md"},[t("div",ze,[l(I,{class:"bg-primary text-white q-mb-md"},{default:n(()=>[t("div",null,[e[28]||(e[28]=t("strong",null,"Exam Name:",-1)),L(" "+d(a.exam_name)+" ",1),e[29]||(e[29]=t("br",null,null,-1)),e[30]||(e[30]=t("strong",null,"Exam Date:",-1)),L(" "+d(a.exam_date),1)])]),_:2},1024),l(w,{bordered:"",class:"q-pa-none"},{default:n(()=>[l(k,null,{default:n(()=>[e[31]||(e[31]=t("div",null,[t("strong",null,"Subjects:")],-1)),l(ue,{class:"q-mt-sm"},{default:n(()=>[(m(!0),f(j,null,q(b.value.exam_marks.filter(c=>c.subject.exam_id===a.id),(c,S)=>(m(),T(pe,{key:c.id,class:"q-mb-xs"},{default:n(()=>[l(M,null,{default:n(()=>[t("div",null,[t("strong",null,d(c.subject.subject_name),1)]),t("div",Ye,"Exam Date: "+d(c.subject.exam_date),1)]),_:2},1024),l(M,{side:""},{default:n(()=>[t("div",Ke,d(c.marks)+" Marks",1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))])):P("",!0)]),_:1}),l(N,null,{default:n(()=>[l(r,{flat:"",label:"Close",onClick:e[11]||(e[11]=a=>h.value=!1),color:"primary"})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(R,{modelValue:_.value,"onUpdate:modelValue":e[15]||(e[15]=a=>_.value=a),persistent:""},{default:n(()=>[l(w,{style:{"min-width":"450px"}},{default:n(()=>[l(k,null,{default:n(()=>[e[32]||(e[32]=t("div",{class:"text-h6 q-mb-md"},"Assign Exam Center to Selected Applicants",-1)),l(V,{modelValue:E(v).exam_center_id,"onUpdate:modelValue":e[13]||(e[13]=a=>E(v).exam_center_id=a),options:i.examCenters,label:"Select Exam Center",dense:"",outlined:"","option-label":"center_name","option-value":"id"},null,8,["modelValue","options"])]),_:1}),l(N,null,{default:n(()=>[l(r,{flat:"",label:"Cancel",onClick:e[14]||(e[14]=a=>_.value=!1),color:"primary"}),l(r,{flat:"",disable:!E(v).exam_center_id,label:"Assign",onClick:W,color:"primary"},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]}),_:1}))}}),rt=xe(Je,[["__scopeId","data-v-80d89333"]]);export{rt as default};
